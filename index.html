<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ARC labeling interface</title>

  <!-- Just to silence warning about not having icon -->
  <link rel="shortcut icon" href="#" />

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-firestore.js"></script>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.css">

  <!-- JS Libraries -->
  <!-- jQuery library -->
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
 
  <!-- Bootstrap JS (must be listed after jQuery) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <!-- CSS files -->
  <link rel="stylesheet" type="text/css" href="css/index.css">
  <link rel="stylesheet" type="text/css" href="css/common.css">
  <link rel="stylesheet" type="text/css" href="css/grids.css">
  <link rel="stylesheet" type="text/css" href="css/testing_interface.css">

  <!-- JS files -->
  <script src="js/index.js"></script>
  <script src="js/grids.js"></script>
  <script src="js/common.js"></script>
  <script src="js/constants.js"></script>
  <script src="js/more_grids.js"></script>
  <script src="js/fire.js"></script>

  <!-- Font reference -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />

</head>

<body>
    <!-- Progress Bar -->
    <div id="progress-bar-complete">
        <div class="progress md-progress">
            <div class="progress-bar success" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="11"></div>
        </div>
    
        <div class="progress-meter">
            <div class="meter meter-right" style="width: 50.00%;"><span class="meter-text">All Done!</span></div>
            <div class="meter meter-right" style="width: 33.33%;"><span class="meter-text">Finished Tutorial</span></div>
            <div class="meter meter-right" style="width: 16.67%;"><span class="meter-text">Finished Instructions</span></div>
        </div>
    </div>

    <!-- Actual Body -->
    <div id="container-fluid">

        <div class="alert alert-success" id="info_display"></div>
        <div class="alert alert-danger" id="error_display"></div>

        <div id="tut-layer">
            <div id="dark-layer"></div>
            <div id="tut-message"></div>
            <div id="tut-continue-message">Click to continue</div>
        </div>

        <div class="row">
            <div id="objective-col"class="col-md">
                <h3 class="objective"><b>Objective:</b></h3>
                <h5 class="objective" id="objective-text">Create the correct output based on the description, example transformations, and input grid.</h5>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4" id="description-col">
                <div class="col-header">
                    <h1 class="col-title">Description</h1>
                </div>

                <div id="description-text">
                    <p id="grid_size_p">The grid size...</p>
                    <p id="see_p">In the input, you should see...</p>
                    <p id="do_p">To make the output, you have to...</p>
                </div>

                <hr>
                <h3>Example Transformation</h3>
                <div id="task_preview">
                    Loading...
                </div>
            </div>

            <div class="col-md-4" id="input-col">
                <div class="col-header">
                    <h1 class="col-title">Input</h1>
                </div>

                <div id="evaluation_input" class="selectable_grid">
                    Loading...
                </div>
            </div>
    
            <div class="col-md-4" id="output-col">

                <div class="col-header">
                    <h1 class="col-title">Output</h1>
                </div>

                <div id="output_grid">
                    <div class="edition_grid selectable_grid">
                        <div class="row">
                            <div class="cell" symbol="0" x="0" y="0"></div>
                            <div class="cell" symbol="0" x="0" y="1"></div>
                            <div class="cell" symbol="0" x="0" y="2"></div>
                        </div>
                        <div class="row">
                            <div class="cell" symbol="0" x="1" y="0"></div>
                            <div class="cell" symbol="0" x="1" y="1"></div>
                            <div class="cell" symbol="0" x="1" y="2"></div>
                        </div>
                        <div class="row">
                            <div class="cell" symbol="0" x="2" y="0"></div>
                            <div class="cell" symbol="0" x="2" y="1"></div>
                            <div class="cell" symbol="0" x="2" y="2"></div>
                        </div>
                    </div>
                </div>

                <div id="resize_control_btns">
                    <label for="output_grid_size">Change grid size: </label>
                    <input type="text" id="output_grid_size" class="grid_size_field" name="size" value="3x3">
                    <button type="button" class="btn btn-primary" onclick="indexResizeOutputGrid()" id="resize_btn">Resize</button>
                </div>

                <div id="edit_control_btns">
                    <button type="button" class="btn btn-secondary" onclick="indexCopyFromInput()">Copy from input</button>
                    <button type="button" class="btn btn-secondary" onclick="indexResetOutputGrid()">Reset grid</button>
                    <button type="button" class="btn btn-success" onclick="check_grid()">Check!</button>
                    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#giveUpModal">Give up</button>
                </div>

                <div id="toolbar_and_symbol_picker">
                    <div id="toolbar">
                        <div>
                            <div id="draw" style="float:left;">
                                <input type="radio" id="tool_edit"
                                name="tool_switching" value="edit" checked>
                               <label for="tool_edit">Draw</label>
                            </div>

                            <div id="floodfill" style="float:left;">
                                <input type="radio" id="tool_floodfill"
                                name="tool_switching" value="floodfill">
                               <label for="tool_floodfill">Flood fill</label>
                            </div>
    
                            <div id="copypaste" style="float:left;">
                                <input type="radio" id="tool_select"
                                name="tool_switching" value="select">
                               <label for="tool_select">Copy-Paste</label>
                            </div>
                        </div>
                    </div>
    
                    <div id="symbol_picker">
                        <div class="symbol_preview symbol_0 selected-symbol-preview" symbol="0"></div>
                        <div class="symbol_preview symbol_1" symbol="1"></div>
                        <div class="symbol_preview symbol_2" symbol="2"></div>
                        <div class="symbol_preview symbol_3" symbol="3"></div>
                        <div class="symbol_preview symbol_4" symbol="4"></div>
                        <div class="symbol_preview symbol_5" symbol="5"></div>
                        <div class="symbol_preview symbol_6" symbol="6"></div>
                        <div class="symbol_preview symbol_7" symbol="7"></div>
                        <div class="symbol_preview symbol_8" symbol="8"></div>
                        <div class="symbol_preview symbol_9" symbol="9"></div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>


      <!-- Consent Modal -->
    <div class="modal fade" id="consentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="gen-modal-title">Informed Consent</h3>
            </div>
            <div class="modal-body" id="gen-modal-body">
                <p>In this study, you will interpret descriptions of an abstract pattern that you observe in grids.</p>
                </br>
                <p>By answering the following questions, you are participating in a study performed by cognitive scientists in the MIT Department of Brain and Cognitive Science. If you have questions about this research, please contact Sam Acquaviva at samacqua@mit.edu. Your participation in this research is voluntary. You may decline to answer any or all of the following questions. You may decline further participation, at any time, without adverse consequences. Your anonymity is assured; the researchers who have requested your participation will not receive any personal identifying information about you. By clicking <b>'I AGREE'</b> you indicate your consent to participate in this study.</p>
            </div>
            <div class="modal-footer">
                <!-- from https://stackoverflow.com/a/44391959/5416200 to address an issue I realize wasn't there-->
                <button type="button" class="btn btn-primary" onclick="$('#consentModal').one('hidden.bs.modal', function() { $('#demographic_modal').modal('show'); }).modal('hide');">I AGREE</button>
            </div>
        </div>
    </div>
    </div>

    <!-- Demographic Modal -->
    <div class="modal fade" id="demographic_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Demographics</h3>
                </div>
                <div class="modal-body" id="final-modal-body">
                    <p>Before you begin, please enter your age and gender.</p>

                    <div class="form-group">
                        <label for="gender_form">What is your gender?</label>
                        <select class="form-control" id="gender_form">
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="age_form">What is your age?</label>
                        <input class="form-control" type="text" placeholder="Enter your age..." id="age_form">
                    </div>


                    <div class="modal-footer">
                        <button onclick="exit_demographic()" type="button" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Introduction Modal -->
    <div class="modal fade" id="introModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Overview of Your Role</h3>
                </div>
                    <div class="modal-body" id="gen-modal-body">

                        <p>If I showed you this grid:</p>

                        <img class="io" src="img/grid_inp_1.png">

                        <p>And I told you: </p>
                        <p><strong>"Make this grid blue"</strong></p>
                        <p>Would you be able to make this transformation? Would you create the correct output shown below (hover over to show)?</p>

                        <img class="io" id="io_ex"src="img/grid_out_1.png">

                        <hr>
                        <p>Great! If I gave you this grid:</p>

                        <img class="io" src="img/grid_inp_2.png">

                        <p>And I told you:</p>
                            <p><strong>"You should see a 3x3 grid with a colored dot in the middle. Create a 5x5 grid that is filled with the middle color."</strong></p>
                        <p> Would you be able to make this transformation? Would you create the correct output shown below (hover over to show)?</p>

                        <img class="io" id="io_ex" src="img/grid_out_2.png">

                        <p>These are the tasks you will solve in this study. You will be given a description of a transformation, and you will have to use that description to create the correct output. Sometimes, you will also be given an example of the transformation.</p>
                        <p><b>It is important that you use as few attempts as possible. The more tasks you complete, and the fewer attempts you take on each, the bigger reward you will get.</b></p>
                        <p>You can always give up on a task, but you will not be given a bonus for that task.</p>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="START_TIME = new Date(); continue_tutorial()">Continue to Examples</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Modal -->
    <div class="modal fade" id="quiz_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Testing Understanding</h3>
                </div>
                    <div class="modal-body" id="gen-modal-body">
    
                        <p>Answer these questions to ensure that you understand the instructions.</p>

                        <div id="quiz"></div>
                        <div id="results"></div>

                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="check_quiz()">Submit Quiz</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div class="modal fade" id="instructionsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Practice</h3>
                </div>
                <div class="modal-body" id="gen-modal-body">
                    <p>Great! You successfully completed the quiz. Now, you will be given two example descriptions as practice.</p>
                    <p><b>In order to continue, you must solve them both.</b></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="update_progress_bar(tasks_inc=false, prac_inc=true); send_user_complete_instructions_time()" data-dismiss="modal">Okay!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Give-up Modal -->
    <div class="modal fade" id="giveUpModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Give Up</h3>
                </div>
                <div class="modal-body" id="gen-modal-body">
                    <video id="give_up_video" width="320" height="240" controls>
                        <source src="img/give_up_1.mp4" type="video/mp4" autoplay>
                    </video>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Finished -->
    <div class="modal fade" id="done_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="gen-modal-title">Finished Solving Tasks</h3>
                </div>
                    <div class="modal-body" id="gen-modal-body">
    
                        <p>Great job! Now, you will continue to using actual descriptions.</p>
                        <p>You will complete a total of 6 tasks. You will recieve <strong>AMOUNT</strong> for completing the study, and a bonus of <strong>AMOUNT</strong> for each task that you complete correctly.</p>
                        <p>There is a chance that you will have the opportunity to describe a task on your own, for a bonus amount of <strong>AMOUNT</strong>. If so, you will be given more instructions.</p>

                    </div>
                <div class="modal-footer">
                    <button onclick="next_task(first_task=true)" type="button" class="btn btn-primary" data-dismiss="modal">Okay</button>
                </div>
            </div>
        </div>
    </div>

</html>